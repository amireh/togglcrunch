<VirtualHost *:80>
	ServerName www.haxjs.com
	ServerAlias haxjs.com

  <IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}

    RewriteCond %{SERVER_PORT} !^443
    RewriteRule ^ https://www.haxjs.com%{REQUEST_URI} [R=301,L]
  </IfModule>

</VirtualHost>

<VirtualHost *:443>
	ServerAdmin admin@haxjs.com
	ServerName www.haxjs.com
  ServerAlias haxjs.com

	DocumentRoot /var/www/haxjs/www
	<Directory /var/www/haxjs/www>
		AllowOverride None
		Order allow,deny
		allow from all
	</Directory>

	ErrorLog /var/log/apache2/haxjs.com.log

	SSLEngine on
	SSLCertificateKeyFile 	/etc/ssl/private/www.haxjs.com.key
	SSLCertificateFile 			/etc/ssl/certs/www_haxjs_com.crt
	SSLCertificateChainFile /etc/ssl/certs/www_haxjs_com.ca-bundle

	AddType application/javascript         js jsonp
	AddType application/json               json
  AddType audio/ogg                      oga ogg
	AddType audio/mp4                      m4a f4a f4b
	AddType video/ogg                      ogv
	AddType video/mp4                      mp4 m4v f4v f4p
	AddType video/webm                     webm
	AddType video/x-flv                    flv
	AddType     image/svg+xml              svg svgz
	AddEncoding gzip                       svgz
	AddType application/vnd.ms-fontobject  eot
	AddType application/x-font-ttf         ttf ttc
	AddType font/opentype                  otf
	AddType application/x-font-woff        woff
	AddType image/x-icon                        ico
	AddType image/webp                          webp
	AddType text/cache-manifest                 appcache manifest
	AddType text/x-component                    htc
	AddType application/xml                     rss atom xml rdf
	AddType application/x-chrome-extension      crx
	AddType application/x-opera-extension       oex
	AddType application/x-xpinstall             xpi
	AddType application/octet-stream            safariextz
	AddType application/x-web-app-manifest+json webapp
	AddType text/x-vcard                        vcf
	AddType application/x-shockwave-flash       swf
	AddType text/vtt                            vtt

	<IfModule mod_deflate.c>
	  <IfModule mod_setenvif.c>
	    <IfModule mod_headers.c>
	      SetEnvIfNoCase ^(Accept-EncodXng|X-cept-Encoding|X{15}|~{15}|-{15})$ ^((gzip|deflate)\s*,?\s*)+|[X~-]{4,13}$ HAVE_Accept-Encoding
	      RequestHeader append Accept-Encoding "gzip,deflate" env=HAVE_Accept-Encoding
	    </IfModule>
	  </IfModule>

	  <IfModule mod_filter.c>
	    AddOutputFilterByType DEFLATE application/atom+xml \
	                                  application/javascript \
	                                  application/json \
	                                  application/json;charset=utf-8 \
	                                  application/rss+xml \
	                                  application/vnd.ms-fontobject \
	                                  application/x-font-ttf \
	                                  application/xhtml+xml \
	                                  application/xml \
	                                  font/opentype \
	                                  image/svg+xml \
	                                  image/x-icon \
	                                  text/css \
	                                  text/html \
	                                  text/plain \
	                                  text/x-component \
	                                  text/xml
	  </IfModule>
	</IfModule>

	# Disable caching since we're using AppCache
	<IfModule mod_expires.c>
	  ExpiresActive off
	  ExpiresDefault "access plus 0 seconds"
	</IfModule>

	# ----------------------------------------------------------------------
	# ETag removal
	# ----------------------------------------------------------------------

	# FileETag None is not enough for every server.
	<IfModule mod_headers.c>
	  Header unset ETag
	</IfModule>

	# Since we're sending far-future expires, we don't need ETags for
	# static content.
	#   developer.yahoo.com/performance/rules.html#etags
	FileETag None

  # If you're using Backbone, or an in-page router with history pushState,
  # this will redirect any non-root URIs into the root URI and then delegate
  # to your app router
  # <IfModule mod_rewrite.c>
  #   Options +FollowSymlinks
  #   RewriteEngine On

  #   # Forward stuff that doesn't exist; not a file, directory, or a symlink
  #   RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-f
  #   RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-d
  #   RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-l

  #   # Forward routes that don't end with an extension, ie: no explicit file requests
  #   RewriteCond %{REQUEST_FILENAME} !\.\w{2,}$

  #   # Forward to Backbone's router
  #   RewriteRule ^ /index.html [L,QSA]
  # </IfModule>

	# <IfModule mod_rewrite.c>
	#   RewriteCond %{HTTP_HOST} !^www\..+$ [NC]
	#   RewriteRule ^ http://www.%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
	# </IfModule>

	Options -MultiViews

	# Use UTF-8 encoding for anything served text/plain or text/html
	AddDefaultCharset utf-8

	# Force UTF-8 for a number of file formats
	AddCharset utf-8 .atom .css .js .json .rss .vtt .xml

	<IfModule mod_autoindex.c>
	  Options -Indexes
	</IfModule>
</VirtualHost>

